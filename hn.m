clc,clear

%%
N3moi100 = [0.169166667000000,0.161455556000000,0.156477778000000,0.155355556000000,0.157333333000000,0.161133333000000,0.167933333000000,0.172966667000000,0.177344444000000,0.180733333000000,0.186988889000000,0.194144444000000,0.200877778000000,0.210077778000000,0.220755556000000,0.231433333000000,0.246311111000000,0.257166667000000,0.268422222000000,0.275633333000000,0.286500000000000,0.294000000000000,0.300211111000000,0.307211111000000,0.314266667000000,0.319911111000000,0.326644444000000,0.330577778000000,0.332611111000000,0.334755556000000,0.337655556000000,0.340611111000000,0.343588889000000,0.342722222000000,0.346655556000000,0.349922222000000,0.349411111000000,0.350244444000000,0.351122222000000,0.351166667000000,0.352533333000000,0.352966667000000,0.355166667000000,0.355333333000000,0.358488889000000,0.361511111000000,0.363722222000000,0.368600000000000,0.374266667000000,0.382966667000000,0.391966667000000,0.405955556000000,0.425955556000000,0.451566667000000,0.479633333000000,0.513455556000000,0.549977778000000,0.585711111000000,0.616922222000000,0.647455556000000,0.675044444000000,0.698755556000000,0.720155556000000,0.736711111000000,0.754277778000000,0.763111111000000,0.777044444000000,0.794400000000000,0.804311111000000,0.812966667000000,0.832233333000000,0.850244444000000,0.861700000000000,0.884200000000000,0.903088889000000,0.925766667000000,0.947700000000000,0.977722222000000,1.00401111100000,1.02712222200000,1.05256666700000,1.07385555600000,1.09944444400000,1.11527777800000,1.11631111100000,1.13137777800000,1.14331111100000,1.15403333300000,1.16141111100000,1.16570000000000,1.17268888900000,1.17953333300000,1.18535555600000,1.18921111100000,1.19762222200000
    ]*5*10^8;
N3moi10 = [0.180777778000000,0.154444444000000,0.144711111000000,0.142722222000000,0.145255556000000,0.147066667000000,0.153577778000000,0.165466667000000,0.167233333000000,0.181088889000000,0.186788889000000,0.195888889000000,0.206288889000000,0.223277778000000,0.227777778000000,0.230933333000000,0.241311111000000,0.246944444000000,0.253833333000000,0.258855556000000,0.262555556000000,0.268477778000000,0.275100000000000,0.277966667000000,0.280988889000000,0.285988889000000,0.287066667000000,0.289622222000000,0.291311111000000,0.293800000000000,0.295566667000000,0.294977778000000,0.297188889000000,0.297577778000000,0.298733333000000,0.299655556000000,0.299788889000000,0.299855556000000,0.300455556000000,0.300788889000000,0.301033333000000,0.302100000000000,0.302988889000000,0.302766667000000,0.305466667000000,0.307055556000000,0.309922222000000,0.313933333000000,0.316888889000000,0.322044444000000,0.330022222000000,0.342566667000000,0.360633333000000,0.382633333000000,0.411066667000000,0.441033333000000,0.470222222000000,0.503022222000000,0.533355556000000,0.565366667000000,0.595722222000000,0.627366667000000,0.654977778000000,0.681311111000000,0.701200000000000,0.725255556000000,0.751488889000000,0.768155556000000,0.780766667000000,0.805144444000000,0.816855556000000,0.839533333000000,0.857055556000000,0.881511111000000,0.897455556000000,0.919577778000000,0.946111111000000,0.969255556000000,0.995077778000000,1.02420000000000,1.04712222200000,1.07400000000000,1.09911111100000,1.13056666700000,1.14858888900000,1.16268888900000,1.17473333300000,1.18756666700000,1.20281111100000,1.21242222200000,1.22214444400000,1.23184444400000,1.23524444400000,1.24378888900000,1.25381111100000
    ]*5*10^8;
N3moi1 = [0.179833333000000,0.160044444000000,0.157600000000000,0.164800000000000,0.185822222000000,0.188866667000000,0.175266667000000,0.180444444000000,0.199055556000000,0.244277778000000,0.258688889000000,0.306400000000000,0.315566667000000,0.331177778000000,0.342900000000000,0.350111111000000,0.356955556000000,0.356755556000000,0.360522222000000,0.356088889000000,0.349055556000000,0.348877778000000,0.346833333000000,0.346044444000000,0.343544444000000,0.341522222000000,0.330477778000000,0.328688889000000,0.326833333000000,0.326966667000000,0.325533333000000,0.325311111000000,0.322477778000000,0.320822222000000,0.319800000000000,0.320255556000000,0.318811111000000,0.318566667000000,0.319466667000000,0.318277778000000,0.318777778000000,0.318188889000000,0.317877778000000,0.318633333000000,0.318144444000000,0.319255556000000,0.319666667000000,0.320255556000000,0.321166667000000,0.325077778000000,0.325944444000000,0.330844444000000,0.337888889000000,0.347755556000000,0.359066667000000,0.376288889000000,0.397566667000000,0.423177778000000,0.452644444000000,0.480744444000000,0.512400000000000,0.543211111000000,0.574255556000000,0.603922222000000,0.633733333000000,0.659666667000000,0.689533333000000,0.716366667000000,0.742222222000000,0.771277778000000,0.793111111000000,0.814733333000000,0.839244444000000,0.857811111000000,0.882288889000000,0.903922222000000,0.921522222000000,0.942911111000000,0.967644444000000,0.984166667000000,1.00903333300000,1.02950000000000,1.06688888900000,1.08567777800000,1.11390000000000,1.13805555600000,1.16225555600000,1.18683333300000,1.21156666700000,1.23180000000000,1.24830000000000,1.26023333300000,1.27133333300000,1.27894444400000,1.28946666700000
    ]*5*10^8;
N3moi01 = [0.174487500000000,0.159350000000000,0.162225000000000,0.175550000000000,0.209987500000000,0.249737500000000,0.268887500000000,0.284712500000000,0.219725000000000,0.274550000000000,0.367637500000000,0.385412500000000,0.389100000000000,0.401275000000000,0.407312500000000,0.410687500000000,0.418200000000000,0.423550000000000,0.415112500000000,0.409100000000000,0.371025000000000,0.354862500000000,0.339700000000000,0.329075000000000,0.321425000000000,0.314437500000000,0.309525000000000,0.307475000000000,0.304387500000000,0.302737500000000,0.300037500000000,0.298537500000000,0.296050000000000,0.295837500000000,0.292962500000000,0.291712500000000,0.290587500000000,0.289562500000000,0.286675000000000,0.284537500000000,0.283200000000000,0.281737500000000,0.280150000000000,0.278600000000000,0.275812500000000,0.274412500000000,0.272687500000000,0.272062500000000,0.271587500000000,0.272062500000000,0.272425000000000,0.273462500000000,0.275225000000000,0.278762500000000,0.282850000000000,0.287062500000000,0.293500000000000,0.300650000000000,0.311487500000000,0.324950000000000,0.340462500000000,0.357125000000000,0.376725000000000,0.399012500000000,0.421200000000000,0.446112500000000,0.474100000000000,0.501962500000000,0.530062500000000,0.559150000000000,0.589912500000000,0.615312500000000,0.642762500000000,0.668737500000000,0.691350000000000,0.715100000000000,0.737412500000000,0.760137500000000,0.783062500000000,0.804412500000000,0.825287500000000,0.848137500000000,0.869887500000000,0.896112500000000,0.920812500000000,0.948687500000000,0.973575000000000,1.00107500000000,1.02736250000000,1.05555000000000,1.08251250000000,1.10735000000000,1.12970000000000,1.15187500000000,1.17066250000000
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N3moi001 = [0.172325000000000,0.159787500000000,0.163625000000000,0.178937500000000,0.216700000000000,0.272362500000000,0.319275000000000,0.364000000000000,0.377450000000000,0.410075000000000,0.470362500000000,0.513825000000000,0.569212500000000,0.601037500000000,0.601175000000000,0.597087500000000,0.544075000000000,0.513650000000000,0.500937500000000,0.449275000000000,0.425575000000000,0.420037500000000,0.419550000000000,0.417662500000000,0.415162500000000,0.413687500000000,0.414525000000000,0.414175000000000,0.417312500000000,0.416312500000000,0.416887500000000,0.422325000000000,0.421562500000000,0.427412500000000,0.431762500000000,0.437162500000000,0.441237500000000,0.443475000000000,0.447287500000000,0.449987500000000,0.451337500000000,0.449112500000000,0.449112500000000,0.448162500000000,0.445387500000000,0.441675000000000,0.438775000000000,0.434562500000000,0.430700000000000,0.425150000000000,0.421487500000000,0.417237500000000,0.410650000000000,0.405387500000000,0.399950000000000,0.395112500000000,0.389975000000000,0.385212500000000,0.380350000000000,0.377312500000000,0.372412500000000,0.369962500000000,0.366850000000000,0.366387500000000,0.365425000000000,0.365312500000000,0.367650000000000,0.370425000000000,0.375450000000000,0.382575000000000,0.391337500000000,0.402825000000000,0.415525000000000,0.430175000000000,0.445787500000000,0.463200000000000,0.484900000000000,0.505250000000000,0.526325000000000,0.547175000000000,0.568825000000000,0.589425000000000,0.610312500000000,0.631075000000000,0.648812500000000,0.667600000000000,0.687425000000000,0.702162500000000,0.719312500000000,0.732125000000000,0.749437500000000,0.768537500000000,0.787650000000000,0.805275000000000,0.827537500000000
    ]*5*10^8;

I3moi100 = N3moi100;
I3moi10 = N3moi10;
I3moi1 = N3moi1 * 1;
I3moi01 = N3moi01 * 0.1;
I3moi001 = N3moi001 * 0.01;

P3moi10 = N3moi10 * 10;
P3moi100 = N3moi100 * 100;
P3moi1 = N3moi1 * 1;
P3moi01 = N3moi01 * 0.1;
P3moi001 = N3moi001 * 0.01;

S3moi100 = N3moi100 - I3moi100;
S3moi10 = N3moi10- I3moi10;
S3moi1 = N3moi100 - I3moi1;
S3moi01 = N3moi01 - I3moi01;
S3moi001 = N3moi001 - I3moi001;
%%
% plot(t,Nmoi100)
% hold on
% plot(t,Nmoi10)
% hold on
% plot(t,Nmoi1)
% hold on
% plot(t,Nmoi01)
% hold on
% plot(t,Nmoi001)
% hold on
%%
t = 0 : 0.25 : 23.5;

T=0.45;
alpha = 0.5496 ;
beta=0.33;
r=100;
d=0;
b = 134;
C = 1.467 * 5 * 10^8;
%%
S(1:4) = S3moi01(1:4);
P(1:4) = P3moi01(1:4);
I(1:4) = I3moi01(1:4);
N(1:4) = N3moi01(1:4);

for i = 5 : length(t)
    
    if S(i-1)>0
        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
        N(i) = S(i) + I(i);
    end
    if S(i-1)<=0
        S(i) = 0;
        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
        N(i) = S(i) + I(i);
    end
    
end
plot(N)
hold on
plot(N3moi01)
corrcoef(N,N3moi01)
% legend('Ô­Ê¼','ÄâºÏ')


clc,clear
%%
%tips
%我们对培养基容量进行了取整
%alpha也参与拟合
%r是100
%T是0.45hour
%%
options={'菌种','moi'};
topic='参数设置';
lines=1;
def={'3','0.1'};
h=inputdlg(options,topic,lines,def);
type=eval(h{1});
moi=eval(h{2});
%%
tic
if type ==1
    b = 42;
end
if type == 2
    b = 116;
end
if type == 3
    b = 134;
end
C = 1.467 * 5 * 10^8;
T = 0.45;
r = 100;
alpha = 0.5496 ;
%%
%type3
N3moi100 = [0.169166667000000,0.161455556000000,0.156477778000000,0.155355556000000,0.157333333000000,0.161133333000000,0.167933333000000,0.172966667000000,0.177344444000000,0.180733333000000,0.186988889000000,0.194144444000000,0.200877778000000,0.210077778000000,0.220755556000000,0.231433333000000,0.246311111000000,0.257166667000000,0.268422222000000,0.275633333000000,0.286500000000000,0.294000000000000,0.300211111000000,0.307211111000000,0.314266667000000,0.319911111000000,0.326644444000000,0.330577778000000,0.332611111000000,0.334755556000000,0.337655556000000,0.340611111000000,0.343588889000000,0.342722222000000,0.346655556000000,0.349922222000000,0.349411111000000,0.350244444000000,0.351122222000000,0.351166667000000,0.352533333000000,0.352966667000000,0.355166667000000,0.355333333000000,0.358488889000000,0.361511111000000,0.363722222000000,0.368600000000000,0.374266667000000,0.382966667000000,0.391966667000000,0.405955556000000,0.425955556000000,0.451566667000000,0.479633333000000,0.513455556000000,0.549977778000000,0.585711111000000,0.616922222000000,0.647455556000000,0.675044444000000,0.698755556000000,0.720155556000000,0.736711111000000,0.754277778000000,0.763111111000000,0.777044444000000,0.794400000000000,0.804311111000000,0.812966667000000,0.832233333000000,0.850244444000000,0.861700000000000,0.884200000000000,0.903088889000000,0.925766667000000,0.947700000000000,0.977722222000000,1.00401111100000,1.02712222200000,1.05256666700000,1.07385555600000,1.09944444400000,1.11527777800000,1.11631111100000,1.13137777800000,1.14331111100000,1.15403333300000,1.16141111100000,1.16570000000000,1.17268888900000,1.17953333300000,1.18535555600000,1.18921111100000,1.19762222200000
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N3moi10 = [0.180777778000000,0.154444444000000,0.144711111000000,0.142722222000000,0.145255556000000,0.147066667000000,0.153577778000000,0.165466667000000,0.167233333000000,0.181088889000000,0.186788889000000,0.195888889000000,0.206288889000000,0.223277778000000,0.227777778000000,0.230933333000000,0.241311111000000,0.246944444000000,0.253833333000000,0.258855556000000,0.262555556000000,0.268477778000000,0.275100000000000,0.277966667000000,0.280988889000000,0.285988889000000,0.287066667000000,0.289622222000000,0.291311111000000,0.293800000000000,0.295566667000000,0.294977778000000,0.297188889000000,0.297577778000000,0.298733333000000,0.299655556000000,0.299788889000000,0.299855556000000,0.300455556000000,0.300788889000000,0.301033333000000,0.302100000000000,0.302988889000000,0.302766667000000,0.305466667000000,0.307055556000000,0.309922222000000,0.313933333000000,0.316888889000000,0.322044444000000,0.330022222000000,0.342566667000000,0.360633333000000,0.382633333000000,0.411066667000000,0.441033333000000,0.470222222000000,0.503022222000000,0.533355556000000,0.565366667000000,0.595722222000000,0.627366667000000,0.654977778000000,0.681311111000000,0.701200000000000,0.725255556000000,0.751488889000000,0.768155556000000,0.780766667000000,0.805144444000000,0.816855556000000,0.839533333000000,0.857055556000000,0.881511111000000,0.897455556000000,0.919577778000000,0.946111111000000,0.969255556000000,0.995077778000000,1.02420000000000,1.04712222200000,1.07400000000000,1.09911111100000,1.13056666700000,1.14858888900000,1.16268888900000,1.17473333300000,1.18756666700000,1.20281111100000,1.21242222200000,1.22214444400000,1.23184444400000,1.23524444400000,1.24378888900000,1.25381111100000
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N3moi1 = [0.179833333000000,0.160044444000000,0.157600000000000,0.164800000000000,0.185822222000000,0.188866667000000,0.175266667000000,0.180444444000000,0.199055556000000,0.244277778000000,0.258688889000000,0.306400000000000,0.315566667000000,0.331177778000000,0.342900000000000,0.350111111000000,0.356955556000000,0.356755556000000,0.360522222000000,0.356088889000000,0.349055556000000,0.348877778000000,0.346833333000000,0.346044444000000,0.343544444000000,0.341522222000000,0.330477778000000,0.328688889000000,0.326833333000000,0.326966667000000,0.325533333000000,0.325311111000000,0.322477778000000,0.320822222000000,0.319800000000000,0.320255556000000,0.318811111000000,0.318566667000000,0.319466667000000,0.318277778000000,0.318777778000000,0.318188889000000,0.317877778000000,0.318633333000000,0.318144444000000,0.319255556000000,0.319666667000000,0.320255556000000,0.321166667000000,0.325077778000000,0.325944444000000,0.330844444000000,0.337888889000000,0.347755556000000,0.359066667000000,0.376288889000000,0.397566667000000,0.423177778000000,0.452644444000000,0.480744444000000,0.512400000000000,0.543211111000000,0.574255556000000,0.603922222000000,0.633733333000000,0.659666667000000,0.689533333000000,0.716366667000000,0.742222222000000,0.771277778000000,0.793111111000000,0.814733333000000,0.839244444000000,0.857811111000000,0.882288889000000,0.903922222000000,0.921522222000000,0.942911111000000,0.967644444000000,0.984166667000000,1.00903333300000,1.02950000000000,1.06688888900000,1.08567777800000,1.11390000000000,1.13805555600000,1.16225555600000,1.18683333300000,1.21156666700000,1.23180000000000,1.24830000000000,1.26023333300000,1.27133333300000,1.27894444400000,1.28946666700000
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N3moi01 = [0.174487500000000,0.159350000000000,0.162225000000000,0.175550000000000,0.209987500000000,0.249737500000000,0.268887500000000,0.284712500000000,0.219725000000000,0.274550000000000,0.367637500000000,0.385412500000000,0.389100000000000,0.401275000000000,0.407312500000000,0.410687500000000,0.418200000000000,0.423550000000000,0.415112500000000,0.409100000000000,0.371025000000000,0.354862500000000,0.339700000000000,0.329075000000000,0.321425000000000,0.314437500000000,0.309525000000000,0.307475000000000,0.304387500000000,0.302737500000000,0.300037500000000,0.298537500000000,0.296050000000000,0.295837500000000,0.292962500000000,0.291712500000000,0.290587500000000,0.289562500000000,0.286675000000000,0.284537500000000,0.283200000000000,0.281737500000000,0.280150000000000,0.278600000000000,0.275812500000000,0.274412500000000,0.272687500000000,0.272062500000000,0.271587500000000,0.272062500000000,0.272425000000000,0.273462500000000,0.275225000000000,0.278762500000000,0.282850000000000,0.287062500000000,0.293500000000000,0.300650000000000,0.311487500000000,0.324950000000000,0.340462500000000,0.357125000000000,0.376725000000000,0.399012500000000,0.421200000000000,0.446112500000000,0.474100000000000,0.501962500000000,0.530062500000000,0.559150000000000,0.589912500000000,0.615312500000000,0.642762500000000,0.668737500000000,0.691350000000000,0.715100000000000,0.737412500000000,0.760137500000000,0.783062500000000,0.804412500000000,0.825287500000000,0.848137500000000,0.869887500000000,0.896112500000000,0.920812500000000,0.948687500000000,0.973575000000000,1.00107500000000,1.02736250000000,1.05555000000000,1.08251250000000,1.10735000000000,1.12970000000000,1.15187500000000,1.17066250000000
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N3moi001 = [0.172325000000000,0.159787500000000,0.163625000000000,0.178937500000000,0.216700000000000,0.272362500000000,0.319275000000000,0.364000000000000,0.377450000000000,0.410075000000000,0.470362500000000,0.513825000000000,0.569212500000000,0.601037500000000,0.601175000000000,0.597087500000000,0.544075000000000,0.513650000000000,0.500937500000000,0.449275000000000,0.425575000000000,0.420037500000000,0.419550000000000,0.417662500000000,0.415162500000000,0.413687500000000,0.414525000000000,0.414175000000000,0.417312500000000,0.416312500000000,0.416887500000000,0.422325000000000,0.421562500000000,0.427412500000000,0.431762500000000,0.437162500000000,0.441237500000000,0.443475000000000,0.447287500000000,0.449987500000000,0.451337500000000,0.449112500000000,0.449112500000000,0.448162500000000,0.445387500000000,0.441675000000000,0.438775000000000,0.434562500000000,0.430700000000000,0.425150000000000,0.421487500000000,0.417237500000000,0.410650000000000,0.405387500000000,0.399950000000000,0.395112500000000,0.389975000000000,0.385212500000000,0.380350000000000,0.377312500000000,0.372412500000000,0.369962500000000,0.366850000000000,0.366387500000000,0.365425000000000,0.365312500000000,0.367650000000000,0.370425000000000,0.375450000000000,0.382575000000000,0.391337500000000,0.402825000000000,0.415525000000000,0.430175000000000,0.445787500000000,0.463200000000000,0.484900000000000,0.505250000000000,0.526325000000000,0.547175000000000,0.568825000000000,0.589425000000000,0.610312500000000,0.631075000000000,0.648812500000000,0.667600000000000,0.687425000000000,0.702162500000000,0.719312500000000,0.732125000000000,0.749437500000000,0.768537500000000,0.787650000000000,0.805275000000000,0.827537500000000
    ]*5*10^8-0.08*ones(1,95)*5*10^8;

I3moi100 = N3moi100;
I3moi10 = N3moi10;
I3moi1 = N3moi1 * 1;
I3moi01 = N3moi01 * 0.1;
I3moi001 = N3moi001 * 0.01;

P3moi10 = N3moi10 * 10;
P3moi100 = N3moi100 * 100;
P3moi1 = N3moi1 * 1;
P3moi01 = N3moi01 * 0.1;
P3moi001 = N3moi001 * 0.01;

S3moi100 = N3moi100 - I3moi100;
S3moi10 = N3moi10 - I3moi10;
S3moi1 = N3moi100 - I3moi1;
S3moi01 = N3moi01 - I3moi01;
S3moi001 = N3moi001 - I3moi001;
%%
%type2
N2moi100 = [0.174447059	0.165294118	0.157605882	0.152917647	0.1499	0.147794118	0.146258824	0.145458824	0.144770588	0.144094118	0.143570588	0.143094118	0.142764706	0.142452941	0.142270588	0.142052941	0.141894118	0.141647059	0.141429412	0.141447059	0.141282353	0.141088235	0.140705882	0.140588235	0.140223529	0.140211765	0.140370588	0.139888235	0.139523529	0.1395	0.139223529	0.139058824	0.138911765	0.138647059	0.138576471	0.138347059	0.138164706	0.137835294	0.137652941	0.137664706	0.137188235	0.136958824	0.136947059	0.136594118	0.136358824	0.136035294	0.135794118	0.1356	0.135129412	0.134882353	0.134564706	0.134405882	0.134211765	0.133764706	0.133405882	0.132994118	0.132776471	0.132694118	0.132347059	0.132023529	0.131635294	0.131352941	0.130976471	0.130623529	0.130417647	0.130041176	0.129682353	0.1295	0.129317647	0.129452941	0.128870588	0.128435294	0.128211765	0.127964706	0.127735294	0.127741176	0.127270588	0.127052941	0.127205882	0.126652941	0.126723529	0.1264	0.126176471	0.125935294	0.126052941	0.125552941	0.125570588	0.125064706	0.124941176	0.124852941	0.124664706	0.124464706	0.124311765	0.124105882	0.124052941
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N2moi10 = [0.17553	0.15453	0.1474	0.14695	0.14871	0.14947	0.14815	0.14626	0.14261	0.14088	0.13532	0.12851	0.12402	0.12224	0.12202	0.11978	0.11803	0.11709	0.1136	0.11334	0.11318	0.11311	0.11334	0.11291	0.11291	0.11276	0.11306	0.11288	0.11275	0.11264	0.11298	0.11264	0.11314	0.11291	0.11335	0.11346	0.11394	0.11404	0.11421	0.11403	0.11407	0.11401	0.11419	0.11412	0.11416	0.11419	0.11407	0.11408	0.1142	0.11402	0.11406	0.11414	0.1141	0.11427	0.11395	0.11386	0.11408	0.11404	0.11419	0.11406	0.11421	0.11423	0.11396	0.11397	0.11391	0.11378	0.11377	0.11374	0.11356	0.11356	0.1136	0.1137	0.11298	0.11296	0.11304	0.11318	0.11259	0.11251	0.11285	0.11259	0.11239	0.11222	0.1121	0.11219	0.11228	0.1127	0.1117	0.11255	0.11215	0.11143	0.11204	0.11222	0.1128	0.1122	0.11288
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N2moi1 = [0.165988889	0.154377778	0.145088889	0.150955556	0.168277778	0.1688	0.172977778	0.182044444	0.197966667	0.201744444	0.198633333	0.194966667	0.186333333	0.177133333	0.167244444	0.148566667	0.140511111	0.137011111	0.133455556	0.129544444	0.125855556	0.122111111	0.118788889	0.116	0.113455556	0.111888889	0.110866667	0.110022222	0.109377778	0.1091	0.109255556	0.109411111	0.109222222	0.109222222	0.109833333	0.109655556	0.110377778	0.109711111	0.111066667	0.111566667	0.111433333	0.111322222	0.113222222	0.114533333	0.116644444	0.1167	0.118122222	0.120088889	0.121544444	0.124822222	0.127444444	0.132133333	0.134911111	0.139133333	0.145588889	0.151333333	0.159355556	0.169866667	0.180188889	0.194722222	0.216488889	0.233722222	0.261933333	0.2815	0.320277778	0.342822222	0.375377778	0.412088889	0.433622222	0.460733333	0.471366667	0.515111111	0.536511111	0.5742	0.595	0.621222222	0.625611111	0.647311111	0.6469	0.663822222	0.691966667	0.720044444	0.745988889	0.784688889	0.792322222	0.7956	0.821866667	0.817844444	0.844111111	0.869388889	0.904922222	0.944711111	0.994688889	1.039344444	1.066144444
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N2moi01 = [0.169755556	0.160511111	0.152488889	0.169166667	0.202288889	0.224533333	0.241177778	0.255177778	0.270633333	0.268433333	0.270888889	0.284311111	0.292077778	0.277822222	0.269344444	0.268611111	0.238155556	0.223911111	0.217566667	0.21	0.207722222	0.205	0.203033333	0.200333333	0.196344444	0.193177778	0.19	0.186411111	0.183733333	0.1807	0.177422222	0.174022222	0.171355556	0.169233333	0.164777778	0.162533333	0.159977778	0.158566667	0.157222222	0.156911111	0.157366667	0.156166667	0.156811111	0.155922222	0.156077778	0.156033333	0.157888889	0.160233333	0.163588889	0.163188889	0.166677778	0.169322222	0.1713	0.176677778	0.189411111	0.192944444	0.200566667	0.215444444	0.222366667	0.235177778	0.260233333	0.279444444	0.300711111	0.318477778	0.348677778	0.373233333	0.400777778	0.436811111	0.441577778	0.463611111	0.498477778	0.522144444	0.555866667	0.5832	0.615966667	0.639733333	0.650966667	0.694677778	0.6963	0.722122222	0.7498	0.764866667	0.806022222	0.807188889	0.837477778	0.863788889	0.863255556	0.902966667	0.932888889	0.9687	1.001544444	1.047344444	1.081711111	1.104711111	1.111511111
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N2moi001 = [0.174033333	0.160322222	0.1524	0.171211111	0.206722222	0.256866667	0.309711111	0.347377778	0.331211111	0.414533333	0.464633333	0.491877778	0.5312	0.509844444	0.475955556	0.464066667	0.445644444	0.452022222	0.421844444	0.4123	0.407866667	0.400633333	0.385744444	0.368322222	0.369811111	0.363388889	0.365966667	0.360344444	0.357922222	0.355677778	0.352122222	0.347544444	0.340777778	0.336622222	0.329611111	0.321788889	0.311833333	0.3047	0.295311111	0.287466667	0.277844444	0.267877778	0.2596	0.250455556	0.241722222	0.233944444	0.2282	0.220911111	0.215455556	0.209377778	0.204733333	0.200122222	0.196355556	0.192555556	0.189755556	0.186922222	0.185688889	0.184488889	0.184633333	0.186633333	0.188655556	0.190355556	0.1955	0.202855556	0.210388889	0.219244444	0.231755556	0.246422222	0.262022222	0.278022222	0.294911111	0.313677778	0.333488889	0.356633333	0.377677778	0.397122222	0.411844444	0.428977778	0.450488889	0.465244444	0.481722222	0.500777778	0.517688889	0.535777778	0.550911111	0.574144444	0.594466667	0.618555556	0.643577778	0.6692	0.698988889	0.730111111	0.771311111	0.820288889	0.869477778
    ]*5*10^8-0.08*ones(1,95)*5*10^8;

I2moi100 = N2moi100;
I2moi10 = N2moi10;
I2moi1 = N2moi1 * 1;
I2moi01 = N2moi01 * 0.1;
I2moi001 = N2moi001 * 0.01;

P2moi10 = N2moi10 * 10;
P2moi100 = N2moi100 * 100;
P2moi1 = N2moi1 * 1;
P2moi01 = N2moi01 * 0.1;
P2moi001 = N2moi001 * 0.01;

S2moi100 = N2moi100 - I2moi100;
S2moi10 = N2moi10- I2moi10;
S2moi1 = N2moi100 - I2moi1;
S2moi01 = N2moi01 - I2moi01;
S2moi001 = N2moi001 - I2moi001;
%%
%type 1
N1moi100 = [0.199828571	0.177842857	0.170814286	0.171057143	0.173371429	0.1748	0.174642857	0.174557143	0.174228571	0.173442857	0.172414286	0.171571429	0.171171429	0.169814286	0.168985714	0.1688	0.1681	0.167442857	0.166928571	0.166385714	0.165842857	0.1654	0.164785714	0.164185714	0.1633	0.162842857	0.162157143	0.161928571	0.1608	0.160214286	0.159185714	0.158214286	0.1566	0.154871429	0.153657143	0.152114286	0.149857143	0.148671429	0.147442857	0.146728571	0.145757143	0.145071429	0.142942857	0.141971429	0.141442857	0.139985714	0.139657143	0.139157143	0.137814286	0.137228571	0.136371429	0.135571429	0.135014286	0.134414286	0.1335	0.133714286	0.133014286	0.132557143	0.131871429	0.131514286	0.131985714	0.1306	0.130114286	0.129714286	0.129814286	0.129585714	0.128942857	0.128671429	0.128442857	0.1284	0.128185714	0.1282	0.128185714	0.127728571	0.127271429	0.127142857	0.127042857	0.126857143	0.126414286	0.127228571	0.125557143	0.124228571	0.1242	0.124042857	0.123714286	0.123371429	0.123457143	0.123214286	0.122814286	0.1225	0.122157143	0.122228571	0.121928571	0.121428571	0.121528571
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N1moi10 = [0.185181818	0.164518182	0.156163636	0.1557	0.1576	0.160345455	0.163209091	0.166227273	0.170309091	0.169609091	0.1743	0.175445455	0.175318182	0.174318182	0.172890909	0.172690909	0.170627273	0.169990909	0.168345455	0.166663636	0.164118182	0.161563636	0.160290909	0.157381818	0.154927273	0.151963636	0.150190909	0.1484	0.146236364	0.144618182	0.143081818	0.141481818	0.140245455	0.138572727	0.137572727	0.136681818	0.135554545	0.134690909	0.133945455	0.1333	0.132881818	0.132072727	0.1314	0.1312	0.130636364	0.130881818	0.130163636	0.130218182	0.13	0.129709091	0.129518182	0.129172727	0.1292	0.129390909	0.129345455	0.129636364	0.129209091	0.128936364	0.128836364	0.128736364	0.129118182	0.129954545	0.130427273	0.131063636	0.131409091	0.132127273	0.133218182	0.133272727	0.134236364	0.134390909	0.135009091	0.136181818	0.137336364	0.137681818	0.138890909	0.138845455	0.139754545	0.142563636	0.143763636	0.146690909	0.149990909	0.149163636	0.149754545	0.154909091	0.157863636	0.1628	0.164990909	0.169954545	0.174318182	0.173227273	0.181845455	0.186863636	0.190581818	0.193163636	0.195690909
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N1moi1 = [0.1721125	0.1568875	0.145775	0.151175	0.1677	0.1878625	0.1998	0.201075	0.2124125	0.2288	0.2460875	0.2599625	0.2706375	0.2769625	0.286175	0.2903125	0.2913	0.2910875	0.2882125	0.2838875	0.2807125	0.2789375	0.274975	0.2718125	0.2669625	0.264225	0.2607	0.2583375	0.2579125	0.2571	0.256325	0.2564625	0.254875	0.2549375	0.2549125	0.2554875	0.2565875	0.2580375	0.2596	0.260575	0.2631875	0.2652875	0.267725	0.270275	0.2732125	0.2768125	0.2795625	0.2818875	0.285275	0.2894625	0.2923375	0.2936125	0.2951875	0.2963875	0.2984375	0.3004625	0.3023	0.3044625	0.3020875	0.30705	0.3107375	0.313575	0.316425	0.32215	0.321825	0.3203625	0.3302375	0.3278125	0.3319	0.3389375	0.347875	0.3518	0.3607375	0.3673625	0.3745	0.385375	0.3938875	0.41085	0.4204	0.4345625	0.4457375	0.4623	0.4798375	0.498	0.510425	0.53485	0.5537875	0.574775	0.6022625	0.6248	0.6459	0.6780375	0.698825	0.726375	0.7442375
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N1moi01 = [0.174377778	0.161666667	0.151711111	0.168844444	0.201888889	0.251688889	0.292144444	0.315888889	0.342311111	0.369388889	0.3977	0.426222222	0.460611111	0.481633333	0.5022	0.495355556	0.4807	0.494177778	0.503522222	0.505422222	0.504133333	0.512444444	0.505566667	0.5106	0.517488889	0.529277778	0.533211111	0.539755556	0.549688889	0.559488889	0.572888889	0.588111111	0.607922222	0.628711111	0.638933333	0.648811111	0.662455556	0.679055556	0.690477778	0.704655556	0.716711111	0.732522222	0.743966667	0.7546	0.766333333	0.777822222	0.7915	0.802155556	0.811266667	0.817788889	0.828688889	0.836277778	0.844444444	0.851966667	0.860388889	0.870311111	0.879711111	0.885955556	0.897133333	0.903766667	0.911011111	0.916733333	0.925233333	0.932011111	0.939422222	0.944611111	0.950522222	0.958544444	0.964111111	0.968833333	0.974288889	0.980544444	0.985544444	0.988555556	0.993944444	0.997511111	1.002633333	1.004755556	1.009244444	1.018344444	1.024566667	1.033311111	1.045011111	1.046588889	1.0273	1.038644444	1.050166667	1.068722222	1.087944444	1.110488889	1.089988889	1.092755556	1.070455556	1.036877778	1.014166667
    ]*5*10^8-0.08*ones(1,95)*5*10^8;
N1moi001 = [0.179666667	0.161222222	0.1518	0.170688889	0.206633333	0.263177778	0.328033333	0.378911111	0.440688889	0.508466667	0.552788889	0.581866667	0.615	0.647544444	0.675077778	0.698744444	0.717911111	0.736377778	0.758444444	0.781044444	0.801811111	0.818322222	0.8363	0.854666667	0.873511111	0.894911111	0.909344444	0.923633333	0.940477778	0.956355556	0.973755556	0.987244444	1.005411111	1.022377778	1.047533333	1.063777778	1.081	1.082	1.0798	1.058477778	1.037066667	1.015966667	1.008822222	0.999833333	1.003444444	1.007155556	1.013377778	1.021244444	1.021955556	1.025955556	1.056733333	1.031522222	1.059577778	1.078422222	1.122388889	1.119388889	1.108988889	1.083777778	1.010388889	1.009333333	1.067222222	0.972955556	0.847344444	0.740144444	0.734666667	0.7623	0.766688889	0.738622222	0.737266667	0.743433333	0.744611111	0.7495	0.7499	0.753966667	0.752911111	0.752233333	0.749922222	0.751222222	0.748211111	0.746333333	0.748322222	0.746488889	0.748377778	0.7469	0.741377778	0.752033333	0.751477778	0.759877778	0.755666667	0.761111111	0.766844444	0.764655556	0.741511111	0.752244444	0.746977778
    ]*5*10^8-0.08*ones(1,95)*5*10^8;

I1moi100 = N1moi100;
I1moi10 = N1moi10;
I1moi1 = N1moi1 * 1;
I1moi01 = N1moi01 * 0.1;
I1moi001 = N1moi001 * 0.01;

P1moi10 = N1moi10 * 10;
P1moi100 = N1moi100 * 100;
P1moi1 = N1moi1 * 1;
P1moi01 = N1moi01 * 0.1;
P1moi001 = N1moi001 * 0.01;

S1moi100 = N1moi100 - I1moi100;
S1moi10 = N1moi10- I1moi10;
S1moi1 = N1moi100 - I1moi1;
S1moi01 = N1moi01 - I1moi01;
S1moi001 = N1moi001 - I1moi001;
%%
t = 0 : 0.25 : 23.5;
RR = zeros(101,101);
%%
%type 3
if type == 3
    if moi == 0.01
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S3moi001(1:4);
                P(1:4) = P3moi001(1:4);
                I(1:4) = I3moi001(1:4);
                N(1:4) = N3moi001(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N3moi001);
                RR(y,z) = abs(temp(1,2));
            end
        end
        
    end
    
    if moi == 0.1
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S3moi01(1:4);
                P(1:4) = P3moi01(1:4);
                I(1:4) = I3moi01(1:4);
                N(1:4) = N3moi01(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N3moi01);
                RR(y,z) = abs(temp(1,2));
            end
            
        end
    end
    if moi == 1
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S3moi1(1:4);
                P(1:4) = P3moi1(1:4);
                I(1:4) = I3moi1(1:4);
                N(1:4) = N3moi1(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N3moi1);
                RR(y,z) = abs(temp(1,2));
            end
            
        end
    end
    if moi == 10
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S3moi10(1:4);
                P(1:4) = P3moi10(1:4);
                I(1:4) = I3moi10(1:4);
                N(1:4) = N3moi10(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N3moi10);
                RR(y,z) = abs(temp(1,2));
            end
            
        end
    end
    if moi == 100
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S3moi100(1:4);
                P(1:4) = P3moi100(1:4);
                I(1:4) = I3moi100(1:4);
                N(1:4) = N3moi100(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N3moi100);
                RR(y,z) = abs(temp(1,2));
                
            end
        end
    end
end
%%
%type 2
if type == 2
    if moi == 0.01
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S2moi001(1:4);
                P(1:4) = P2moi001(1:4);
                I(1:4) = I2moi001(1:4);
                N(1:4) = N2moi001(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N2moi001);
                RR(y,z) = abs(temp(1,2));
                
            end
        end
    end
    
    if moi == 0.1
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S2moi01(1:4);
                P(1:4) = P2moi01(1:4);
                I(1:4) = I2moi01(1:4);
                N(1:4) = N2moi01(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N2moi01);
                RR(y,z) = abs(temp(1,2));
                
            end
        end
    end
    if moi == 1
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S2moi1(1:4);
                P(1:4) = P2moi1(1:4);
                I(1:4) = I2moi1(1:4);
                N(1:4) = N2moi1(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N2moi1);
                RR(y,z) = abs(temp(1,2));
                
            end
        end
    end
    if moi == 10
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S2moi10(1:4);
                P(1:4) = P2moi10(1:4);
                I(1:4) = I2moi10(1:4);
                N(1:4) = N2moi10(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N2moi10);
                RR(y,z) = abs(temp(1,2));
                
            end
        end
    end
    if moi == 100
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S2moi100(1:4);
                P(1:4) = P2moi100(1:4);
                I(1:4) = I2moi100(1:4);
                N(1:4) = N2moi100(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N2moi100);
                RR(y,z) = abs(temp(1,2));
                
            end
        end
    end
end
%%
%type 1
if type == 1
    if moi == 0.01
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S1moi001(1:4);
                P(1:4) = P1moi001(1:4);
                I(1:4) = I1moi001(1:4);
                N(1:4) = N1moi001(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N1moi001);
                RR(y,z) = abs(temp(1,2));
                
            end
        end
    end
    
    if moi == 0.1
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S1moi01(1:4);
                P(1:4) = P1moi01(1:4);
                I(1:4) = I1moi01(1:4);
                N(1:4) = N1moi01(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N1moi01);
                RR(y,z) = abs(temp(1,2));
                
            end
        end
    end
    if moi == 1
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S1moi1(1:4);
                P(1:4) = P1moi1(1:4);
                I(1:4) = I1moi1(1:4);
                N(1:4) = N1moi1(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N1moi1);
                RR(y,z) = abs(temp(1,2));
            end
            
        end
    end
    if moi == 10
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S1moi10(1:4);
                P(1:4) = P1moi10(1:4);
                I(1:4) = I1moi10(1:4);
                N(1:4) = N1moi10(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N1moi10);
                RR(y,z) = abs(temp(1,2));
                
            end
        end
    end
    if moi == 100
        
        for y = 1 : 101
            for z = 1 : 101
                
                
                d = 0.01 * (y-1);
                beta = 0.01 * (z-1);
                S(1:4) = S1moi100(1:4);
                P(1:4) = P1moi100(1:4);
                I(1:4) = I1moi100(1:4);
                N(1:4) = N1moi100(1:4);
                
                for i = 5 : length(t)
                    if S(i-1)>0
                        S(i) = t(i-1) * (alpha*S(i-1)-(alpha/C)*S(i-1)*S(i-1)-(alpha/C)*S(i-1)*I(i-1)-beta*P(i-1)*S(i-1)/N(i-1)) + S(i-1);
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                    if S(i-1)<=0
                        S(i) = 0;
                        I(i) = t(i-1) * (beta*S(i-1)*P(i-1)/N(i-1) - exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-d*I(i-1)) + I(i-1);
                        P(i) = t(i-1) * (r+b*exp(-d*T)*beta*S(i-4)*P(i-4)/N(i-4)-beta*S(i-1)*P(i-1)/N(i-1)) + P(i-1);
                        N(i) = S(i) + I(i);
                    end
                end
                temp = corrcoef(N,N1moi100);
                RR(y,z) = abs(temp(1,2));
                
            end
        end
    end
end
%%
pearson = max(max(RR));

[q1,q2]=find(RR==max(RR(:)));
fprintf(['pearson拟合度是',num2str(pearson),';','d=',num2str((q1(1)-1)*0.01),';','beta=',num2str((q2(1)-1)*0.01)])
toc
function u = circuitfun(t,x)
dx=zeros(5,1);
R1=9;
R2=1;
R3=2;
R4=1;
C1=1;
C2=5;
C3=1;
C4=14;
%%
x(5)=x(1)+x(2)+x(3)+x(4);
dx(1)=(C4*dx(5)+x(5)/R4-(1/R1+1/R4+C4/(R1*C2)+C4/(R1*C3))*x(1)-(1/R4-C4/(R2*C2))*x(2)-(1/R4-C4/(R3*C3))*x(3))/(C1+C4+C1*C4/C2+C1*C4/C3);
dx(2)=(C4*dx(5)+x(5)/R4-(1/R1+1/R4+C4/(R1*C3)-(C1+C4)/(R1*C1)-C4/(R1*C3))*x(1)-((C1+C4)/(R2*C1)+1/R4+C4/(R2*C3))*x(2)-(1/R4-C4/(R3*C3))*x(3))/(C2+C4+C2*C4/C1+C2*C4/C3);
dx(3)=(C4*dx(5)+x(5)/R4-(1/R1+1/R4+C4/(R1*C2)-C4/(R1*C2)-(C1+C4)/(R1*C1))*x(1)-(1/R4-C4/(R2*C2))*x(2)-((C1+C4)/(R3*C1)+C4/(R3*C2)+1/R4)*x(3))/(C3+C4+C3*C4/C1+C3*C4/C2);
u=x;
end

